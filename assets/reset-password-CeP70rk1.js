import{_ as P,c as t,a as o,g as f,h as m,f as w,r as k,b as y,d as c,w as _,e as p,j as v,k as b,n as l,t as u,i as g,o as a}from"./app-DC7Ja9De.js";const V={name:"ResetPasswordPage",data(){return{token:"",newPassword:"",confirmPassword:"",showPassword:!1,showPasswordValidation:!1,passwordValidation:{length:!1,upper:!1,number:!1,special:!1},isSubmitting:!1,errorMessage:"",successMessage:"",invalidToken:!1}},created(){if(this.token=this.$route.query.token,!this.token){this.invalidToken=!0;return}this.verifyToken()},computed:{passwordMismatch(){return this.confirmPassword&&this.newPassword!==this.confirmPassword},allValidationsPassed(){return this.passwordValidation.length&&this.passwordValidation.upper&&this.passwordValidation.number&&this.passwordValidation.special&&this.newPassword===this.confirmPassword&&this.newPassword.length>0}},methods:{async verifyToken(){try{(await g.post("/verify-reset-token",{token:this.token})).data.success||(this.invalidToken=!0)}catch(r){console.error("Error verifying token:",r),this.invalidToken=!0}},validatePassword(){const r=this.newPassword;this.passwordValidation.length=r.length>=8,this.passwordValidation.upper=/[A-Z]/.test(r),this.passwordValidation.number=/[0-9]/.test(r),this.passwordValidation.special=/[!@#$%^&*(),.?":{}|<>]/.test(r),this.showPasswordValidation=!0},async handleSubmit(){var r,s;if(this.allValidationsPassed){this.isSubmitting=!0,this.errorMessage="",this.successMessage="";try{const d=await g.post("/reset-password",{token:this.token,password:this.newPassword});d.data.success?(this.successMessage="Password reset successfully! Redirecting to login...",setTimeout(()=>{this.$router.push("/login")},2e3)):this.errorMessage=d.data.message||"Password reset failed."}catch(d){console.error("Error resetting password:",d),this.errorMessage=((s=(r=d.response)==null?void 0:r.data)==null?void 0:s.message)||"An error occurred. Please try again later."}finally{this.isSubmitting=!1}}}}},M={class:"reset-password-bg"},S={class:"reset-password-main"},x={class:"reset-password-card"},T={key:0,class:"invalid-token-container"},C={key:1},N={class:"form-group"},R={class:"input-container password-container"},q=["type"],E={key:0,class:"fas fa-eye"},A={key:1,class:"fas fa-eye-slash"},B={class:"password-rules"},D={class:"form-group"},I={class:"input-container password-container"},O=["type"],U={key:0,class:"fas fa-eye"},j={key:1,class:"fas fa-eye-slash"},z={key:0,class:"mismatch-error"},L=["disabled"],Z={key:0,class:"spinner"},F={key:0,class:"error-message"},G={key:1,class:"success-message"},H={class:"bottom-link"};function J(r,s,d,K,e,n){const h=k("router-link");return a(),t("div",M,[o("div",S,[o("div",x,[e.invalidToken?(a(),t("div",T,[s[7]||(s[7]=o("div",{class:"error-icon"},[o("i",{class:"fas fa-exclamation-triangle"})],-1)),s[8]||(s[8]=o("h3",{class:"error-title"},"Invalid or Expired Link",-1)),s[9]||(s[9]=o("p",{class:"error-text"}," The password reset link you used is either invalid or has expired. ",-1)),f(h,{to:"/forgot-password",class:"request-new-link"},{default:m(()=>s[6]||(s[6]=[w(" Request a new password reset link ")])),_:1,__:[6]})])):(a(),t("div",C,[s[12]||(s[12]=y('<div class="reset-password-header" data-v-29f3ac86><div class="reset-icon" data-v-29f3ac86><i class="fas fa-lock" data-v-29f3ac86></i></div><h2 class="reset-password-title" data-v-29f3ac86>Reset Password</h2><p class="reset-password-subtitle" data-v-29f3ac86>Enter your new password below</p></div>',1)),o("form",{onSubmit:s[5]||(s[5]=_((...i)=>n.handleSubmit&&n.handleSubmit(...i),["prevent"])),class:"reset-password-form"},[o("div",N,[s[10]||(s[10]=o("label",{for:"new-password"},"New Password",-1)),o("div",R,[p(o("input",{type:e.showPassword?"text":"password",id:"new-password","onUpdate:modelValue":s[0]||(s[0]=i=>e.newPassword=i),placeholder:"New Password",required:"",onInput:s[1]||(s[1]=(...i)=>n.validatePassword&&n.validatePassword(...i))},null,40,q),[[v,e.newPassword]]),o("span",{class:"password-toggle",onClick:s[2]||(s[2]=i=>e.showPassword=!e.showPassword)},[e.showPassword?(a(),t("i",E)):(a(),t("i",A))])]),p(o("div",B,[o("div",{class:l({valid:e.passwordValidation.length})},"• At least 8 characters",2),o("div",{class:l({valid:e.passwordValidation.upper})},"• One uppercase letter",2),o("div",{class:l({valid:e.passwordValidation.number})},"• One number",2),o("div",{class:l({valid:e.passwordValidation.special})},"• One special character",2)],512),[[b,e.showPasswordValidation]])]),o("div",D,[s[11]||(s[11]=o("label",{for:"confirm-password"},"Confirm Password",-1)),o("div",I,[p(o("input",{type:e.showPassword?"text":"password",id:"confirm-password","onUpdate:modelValue":s[3]||(s[3]=i=>e.confirmPassword=i),placeholder:"Confirm Password",required:"",class:l({"password-mismatch":n.passwordMismatch})},null,10,O),[[v,e.confirmPassword]]),o("span",{class:"password-toggle",onClick:s[4]||(s[4]=i=>e.showPassword=!e.showPassword)},[e.showPassword?(a(),t("i",U)):(a(),t("i",j))])]),n.passwordMismatch?(a(),t("div",z," Passwords do not match ")):c("",!0)]),o("button",{type:"submit",class:"reset-btn",disabled:!n.allValidationsPassed||e.isSubmitting},[e.isSubmitting?(a(),t("span",Z)):c("",!0),w(" "+u(e.isSubmitting?"Processing...":"Reset Password"),1)],8,L)],32),e.errorMessage?(a(),t("div",F,u(e.errorMessage),1)):c("",!0),e.successMessage?(a(),t("div",G,u(e.successMessage),1)):c("",!0)])),o("div",H,[s[14]||(s[14]=w(" Remember your password? ")),f(h,{to:"/login"},{default:m(()=>s[13]||(s[13]=[w("Sign in")])),_:1,__:[13]})])])])])}const W=P(V,[["render",J],["__scopeId","data-v-29f3ac86"]]);export{W as default};
//# sourceMappingURL=reset-password-CeP70rk1.js.map
